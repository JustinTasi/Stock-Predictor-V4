# Stock-Predictor-V4

![stockpredictor ai logo](https://user-images.githubusercontent.com/53996451/224323224-3ec1cd20-747c-42ad-9fb1-ba6e0ecb358b.png)

> Please note that this is still in the testing phase, so if you encounter any errors, please report them.

---
# Content Table

- [Stock-Predictor-V4](#stock-predictor-v4)
  - [What inspired you to create a Stock-Predictor for your School project?](#what-inspired-you-to-create-a-stock-predictor-for-your-school-project)
  - [How did I narrow down the topic for my Stock-Predictor project and what is the structure of my work?](#how-did-i-narrow-down-the-topic-for-my-stock-predictor-project-and-what-is-the-structure-of-my-work)
  - [1a. Installation](#1a-installation)
  - [1b. Installation with Virtual Environment (venv) in Python](#1b-installation-with-virtual-environment-venv-in-python)
  - [2. Data Preparation](#2-data-preparation)
  - [3. Training the LSTM RL Model](#3-training-the-lstm-rl-model)
  - [4. Evaluating the Model](#4-evaluating-the-model)
  - [5. Fine Tuning the LSTM RL Model](#5-fine-tuning-the-lstm-rl-model)
  - [6. Utilizing the Model for Stock Market Prediction](#6-utilizing-the-model-for-stock-market-prediction)

---

## What inspired you to create a Stock-Predictor for your School project?
As a technology enthusiast, I am constantly on the lookout for innovative ideas to work on and expand my skillset. Therefore, I decided to explore the field of AI and its potential applications in finance.

Motivated by my curiosity and passion for technology, I embarked on a project to create a Stock-Predictor V4. This project involves using advanced algorithms and machine learning techniques to analyze historical data and predict future stock market trends.

By building this project, I hope to contribute to the development of new AI-based solutions that can assist investors and traders in making informed decisions. I am excited to explore this fascinating area of technology and see what possibilities it holds.

---

## How did I narrow down the topic for my Stock-Predictor project and what is the structure of my work?
To narrow down the topic for my Stock-Predictor project, I first researched various areas in finance where AI technology could be applied. After careful consideration, I decided to focus on stock market prediction as it is a crucial aspect of finance that can benefit greatly from AI-based solutions.

My project aims to examine the accuracy and effectiveness of different machine learning models in predicting stock prices. To achieve this, I collected and analyzed historical stock market data and used it to train and test various models, including linear regression, random forest, and neural networks.

The structure of my work involves several key components, including data preprocessing, model selection, feature engineering, and performance evaluation. I first preprocess the data by cleaning and formatting it for analysis. Next, I select the most suitable machine learning model based on its performance metrics. Then, I engineer relevant features to improve the model's accuracy. Finally, I evaluate the performance of the model based on various metrics such as accuracy, precision, and recall.

Overall, my Stock-Predictor project is structured in a way that allows me to systematically examine and represent the effectiveness of AI-based solutions in predicting stock prices.

---

## 1a. Installation
```
git clone https://github.com/Qerim-iseni09/Stock-Predictor-V4.git
cd Stock-Predictor-V4
chmod +x install.sh
./install.sh # Ignore the 2 Messages
```

---

## 1b. Installation with Virtual Environment (venv) in Python
```
git clone https://github.com/Qerim-iseni09/Stock-Predictor-V4.git
pip install venv
python -m venv Stock-Predictor-V4
cd Stock-Predictor-V4
source bin/activate # Execute before using any script
./install.sh # Ignore the 2 Messages
deactivate # Execute this command to deactivate the virtual environment
```

---

## 2. Data Preparation
To prepare the data for your stock prediction, follow these steps:

1. Go to [Yahoo Finance](https://finance.yahoo.com/) and select a stock of your choice.
2. Download the CSV file from the Historical Data tab and save it in the data folder. For example, you can use [Bitcoin](https://finance.yahoo.com/quote/BTC-USD?p=BTC-USD) as an example.
3. Open `prepare_data.py` and change `df = pd.read_csv('data/BTC-USD.csv')` to `df = pd.read_csv('data/<Your Downloaded CSV file>')`, where `<Your Downloaded CSV file>` is the name of the CSV file you downloaded in step 2.
4. Execute `prepare_data.py` by running `python prepare_data.py`.
  
After these steps, your downloaded stock data will have indicators that make predictions more reliable.

---

## 3. Training the LSTM RL Model

To train the LSTM RL Model with the `data.csv` file that was generated by the 2. Step, execute the following:

```
python train.py
```
After running this command, the LSTM RL model will start training with the data in the data.csv file.

---

## 4. Evaluating the Model
To evaluate the trained model, execute the following:

```
python eval.py
```

After running this command, the accuracy, rewards, mean squared error (MSE), and root mean squared error (RMSE) will be plotted.

---

## 5. Fine Tuning the LSTM RL Model

Fine tuning the LSTM RL model will take more time as it will train until it reaches a specific R2 threshold. By default, the R2 threshold is set to 2.85 (An R2 average of 0.95). However, if you want to set a different R2 threshold, open the fine_tune.py file and change the accuracy_threshold variable to your desired target accuracy.

To fine tune the model, execute the following:
```
python fine_tune.py
```

This process will take some time, and it is recommended to hydrate yourself with some water while waiting for the fine-tuning to complete.
After fine-tuning is complete, it is recommended to re-evaluate the model.

---

## 6. Utilizing the Model for Stock Market Prediction
After completing the previous steps, you can use the model to predict the stock market for as many days as you want. The script will prompt you to enter the number of days to predict, and after plotting the predictions, it will ask you to rate the predictions on a scale of 1 to 10. The model will receive a reward based on your rating, which will help it improve its future predictions.

To use the model for prediction, run the following command:

```
python predict.py
```

And Happy Trading!
However, please note that any losses incurred by utilizing the model's predictions are not the responsibility of the developer.
